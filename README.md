# IIITH API

A FastAPI-based secure and performant REST API that performs basic arithmetic operations (addition, multiplication, even/odd check) with built-in:

- JWT Authentication with Role-based Access
- Database Logging of Requests & Responses
- Admin-only Log Retrieval (with Pagination)
- Swagger/OpenAPI Documentation
- Unit & Performance Testing

## ğŸš€ Features

- â• **Arithmetic Operations**: `/add`, `/multiply`, `/check-even-odd`
- ğŸ” **Authentication**: JWT token-based login (`/token`)
- ğŸ§‘â€ğŸ’¼ **Role-based Access**: Admin-only `/logs` endpoint
- ğŸ“ **Request/Response Logging** stored in SQLite
- ğŸ“„ **API Docs** at `/docs` (Swagger) & `/redoc`
- ğŸ§ª **Unit Tests** via `pytest`
- ğŸ“ˆ **Performance Testing** via `locust`

## ğŸ“¦ Technologies

- **Backend Framework**: FastAPI
- **Auth**: OAuth2PasswordBearer + JWT (via `python-jose`)
- **Database**: SQLite (via SQLAlchemy ORM)
- **Testing**: `pytest`, `locust`
- **Docs**: Auto-generated by FastAPI (Swagger/OpenAPI)

## ğŸ› ï¸ Installation

1. Clone the repository:
   ```bash
   git clone https://github.com/Imsachin010/iiith-api.git
   cd iiith-api
   ```

2. Create and activate a virtual environment:
   ```bash
   python -m venv venv
   source venv/bin/activate  # On Windows use `venv\\Scripts\\activate`
   ```

3. Install dependencies using setup.py:
   ```bash
   pip install -e .
   ```
   This will automatically install all required packages defined in setup.py.

## ğŸš€ Running the Server

Start the development server:
```bash
uvicorn app.main:app --reload
```

The API will be available at `http://127.0.0.1:8000`

## ğŸ“š API Documentation

- **Swagger UI**: Visit `http://127.0.0.1:8000/docs`
- **ReDoc**: Visit `http://127.0.0.1:8000/redoc`

## ğŸ”‘ Authentication

1. Get a token using the `/token` endpoint:
   ```bash
   curl -X POST "http://127.0.0.1:8000/token" \
        -H "Content-Type: application/x-www-form-urlencoded" \
        -d "username=admin&password=adminpass"
   ```

2. Use the token in subsequent requests:
   ```bash
   curl -X GET "http://127.0.0.1:8000/logs" \
        -H "Authorization: Bearer <your_token>"
   ```

## ğŸ§ª Testing

### Unit Tests
Run unit tests using pytest:
```bash
pytest tests/
```

### Performance Tests
Run Locust performance tests:
```bash
locust -f locustfile.py
```

## ğŸ“ API Endpoints

### Operations
- **POST `/add`**: Add two numbers
  ```json
  {
    "num1": 5,
    "num2": 3
  }
  ```

- **POST `/multiply`**: Multiply two numbers
  ```json
  {
    "num1": 4,
    "num2": 2
  }
  ```

- **GET `/check-even-odd`**: Check if a number is even or odd
  ```
  /check-even-odd?number=7
  ```

### Admin
- **GET `/logs`**: Retrieve operation logs (admin only)
  ```
  /logs?limit=10&offset=0
  ```

## ğŸ“„ License

This project is licensed under the MIT License. 